#!/bin/sh
# Pre-commit hook to update build info

# Get the current commit ID (will be the previous commit since we're pre-commit)
COMMIT_ID=$(git rev-parse HEAD)
COMMIT_DATE=$(git log -1 --format=%cI)
BUILD_TIME=$(date -u +"%Y-%m-%dT%H:%M:%SZ")

# Update the buildInfo.ts file
cat > src/buildInfo.ts << EOF
// This file is auto-generated by git pre-commit hook
// DO NOT EDIT MANUALLY
export const buildInfo = {
  commitId: '${COMMIT_ID}',
  commitDate: '${COMMIT_DATE}',
  buildTime: '${BUILD_TIME}'
};
EOF

# Add the updated file to the commit
git add src/buildInfo.ts

echo "Updated build info with commit: ${COMMIT_ID}"